# Test Tag Utility for E2E Tests

This utility helps create standardized test IDs (tags) for e2e tests. It makes it easy to identify:
1. Which component is being tested
2. What type of test is being performed
3. When the test was run (with a global timestamp)

## Purpose

- **Standardized Naming**: Consistent format for test IDs across all e2e tests
- **Global Test Run Timestamp**: All tests in a run share the same timestamp
- **Artifact Organization**: Link screenshots, videos, and other artifacts to specific tests
- **Test Traceability**: Easily trace artifacts back to specific test executions

## Format

The test tag format is:
```
componentType.testType-customIdentifier_YYYYMMDD-HHMMSS
```

For example:
```
auth.login_20230615-142233
recipe.create-vegetarian_20230615-142233
profile.update-avatar_20230615-142233
```

## Usage

### Basic Usage

```typescript
import { createTestTag } from '../utils/test-tag';

// Create a test tag with component type and test type
const testTag = createTestTag('auth', 'login');
// Result: auth.login_20230615-142233

// With optional custom identifier
const recipeTag = createTestTag('recipe', 'create', 'vegetarian');
// Result: recipe.create-vegetarian_20230615-142233
```

### With ScreenshotHelper

```typescript
import { createTestTag } from '../utils/test-tag';
import { ScreenshotHelper } from '../utils/screenshot-helper';

// Create a test tag
const testTag = createTestTag('header', 'navigation');

// Pass it to ScreenshotHelper
const screenshots = new ScreenshotHelper(
  page,
  'header-navigation',  // test name
  'navigation',         // category
  '',                   // legacy test ID (can be empty)
  testTag               // our new test tag
);

// Take screenshots that will include the test tag in the filename
await screenshots.take('home-page');
```

### Creating Tagged Filenames

```typescript
import { createTestTag, createTaggedFilename } from '../utils/test-tag';

// Create a test tag
const testTag = createTestTag('auth', 'login');

// Create a filename for a report with the test tag embedded
const reportFilename = createTaggedFilename('auth-report', testTag, '.json');
// Result: auth-report-auth.login_20230615-142233.json
```

### Parsing Test Tags

```typescript
import { parseTestTag } from '../utils/test-tag';

const testTag = 'auth.login-oauth_20230615-142233';
const parsed = parseTestTag(testTag);

// Result:
// {
//   componentType: 'auth',
//   testType: 'login',
//   customIdentifier: 'oauth',
//   timestamp: '20230615-142233'
// }
```

## Global Timestamp

The test run timestamp is set once at the beginning of the test run in `global-setup.ts` and used for all tests in that run. This ensures all tests from the same run have the same timestamp component.

## Examples

See the example test file at `e2e/example-test-tag.spec.ts` for complete working examples.

## Best Practices

1. Use consistent component types across tests (e.g., 'auth', 'recipe', 'profile')
2. Use descriptive test types (e.g., 'create', 'update', 'delete', 'login')
3. Use custom identifiers for specific test variations (e.g., 'vegetarian', 'oauth')
4. Create test tags at the beginning of each test for clarity
5. Use the same test tag for all artifacts generated by a test

## Tips

- Component types should represent major sections or features of your application
- Test types should describe the action being tested
- Custom identifiers can provide additional context when needed
- All components of the test tag are sanitized to ensure they're safe for filenames
